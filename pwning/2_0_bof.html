
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Buffer Overflow · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="2_1_bof_variables.html" />
    
    
    <link rel="prev" href="1_beginning.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Bem vindo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/1_beginning.html">
            
                <a href="../introduction/1_beginning.html">
            
                    
                    Introdução ao Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../introduction/2_assembly.html">
            
                <a href="../introduction/2_assembly.html">
            
                    
                    Assembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../introduction/3_endianness.html">
            
                <a href="../introduction/3_endianness.html">
            
                    
                    Endianness
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../introduction/4_ghidra.html">
            
                <a href="../introduction/4_ghidra.html">
            
                    
                    Ghidra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../introduction/5_gdb.html">
            
                <a href="../introduction/5_gdb.html">
            
                    
                    GDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../introduction/6_pwntools.html">
            
                <a href="../introduction/6_pwntools.html">
            
                    
                    Pwntools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="1_beginning.html">
            
                <a href="1_beginning.html">
            
                    
                    Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="2_0_bof.html">
            
                <a href="2_0_bof.html">
            
                    
                    Buffer Overflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="2_1_bof_variables.html">
            
                <a href="2_1_bof_variables.html">
            
                    
                    Buffer Overflow - Variáveis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="2_2_bof_callfunction.html">
            
                <a href="2_2_bof_callfunction.html">
            
                    
                    Buffer Overflow - CallFunction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="2_3_bof_shellcode.html">
            
                <a href="2_3_bof_shellcode.html">
            
                    
                    Buffer Overflow - ShellCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="3_format_strings.html">
            
                <a href="3_format_strings.html">
            
                    
                    Format Strings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="4_array_indexing.html">
            
                <a href="4_array_indexing.html">
            
                    
                    Array Indexing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="5_integer_overflow.html">
            
                <a href="5_integer_overflow.html">
            
                    
                    Integer Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="6_bad_seed.html">
            
                <a href="6_bad_seed.html">
            
                    
                    Bad seed
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../fast_food/beginning.html">
            
                <a href="../fast_food/beginning.html">
            
                    
                    Fast Food
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../fast_food/introduction/1_beggining.html">
            
                <a href="../fast_food/introduction/1_beggining.html">
            
                    
                    Fast Intro
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../fast_food/introduction/2_assembly.html">
            
                <a href="../fast_food/introduction/2_assembly.html">
            
                    
                    Assembly CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../fast_food/introduction/3_endianness.html">
            
                <a href="../fast_food/introduction/3_endianness.html">
            
                    
                    Endianness
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../fast_food/introduction/4_ghidra.html">
            
                <a href="../fast_food/introduction/4_ghidra.html">
            
                    
                    Ghidra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../fast_food/introduction/5_gdb.html">
            
                <a href="../fast_food/introduction/5_gdb.html">
            
                    
                    GDB CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../fast_food/introduction/6_pwntools.html">
            
                <a href="../fast_food/introduction/6_pwntools.html">
            
                    
                    Pwntools CheatSheet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="1_beginning.html">
            
                <a href="1_beginning.html">
            
                    
                    Fast Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../fast_food/pwning/2_protections.html">
            
                <a href="../fast_food/pwning/2_protections.html">
            
                    
                    Proteções de binários
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../fast_food/pwning/3_bof.html">
            
                <a href="../fast_food/pwning/3_bof.html">
            
                    
                    Buffer Overflow - Variáveis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../fast_food/pwning/4_bof_callfunction.html">
            
                <a href="../fast_food/pwning/4_bof_callfunction.html">
            
                    
                    Buffer Overflow - CallFunction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../fast_food/pwning/5_bof_shellcode.html">
            
                <a href="../fast_food/pwning/5_bof_shellcode.html">
            
                    
                    Buffer Overflow - ShellCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../fast_food/pwning/6_format_strings.html">
            
                <a href="../fast_food/pwning/6_format_strings.html">
            
                    
                    Format Strings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Buffer Overflow</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="21-introdu&#xE7;&#xE3;o-ao-buffer-overflow">2.1 Introdu&#xE7;&#xE3;o ao Buffer Overflow</h2>
<p>Buffer Overflow &#xE9; a arte de <strong>usar inputs para sobrescrever mem&#xF3;ria</strong>. Todos os programas, em geral, esperam uma entrada para produzir uma resposta, certo?</p>
<p>Por exemplo:</p>
<pre><code class="lang-C"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">char</span> nome[<span class="hljs-number">5</span>];

    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, nome);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Voc&#xEA; digitou: %s&quot;</span>, nome);
}
</code></pre>
<p>Acima, temos um array de caracteres que suporta 5 elementos: 4 caracteres e um <code>\0</code> (na mem&#xF3;ria, &#xE9; apenas um 00) no final, que indica que &#xE9; o fim da string.</p>
<p>Simples, n&#xE3;o? O programa ir&#xE1; funcionar com o seu input:</p>
<pre><code>&lt; John
&gt; Voc&#xEA; digitou: John
</code></pre><p>Vamos dar um <code>disass main</code> no pwdgb:</p>
<pre><code>0x0000555555555149 &lt;+0&gt;:     push   rbp
   0x000055555555514a &lt;+1&gt;:     mov    rbp,rsp
=&gt; 0x000055555555514d &lt;+4&gt;:     sub    rsp,0x10
   0x0000555555555151 &lt;+8&gt;:     lea    rax,[rbp-0x5]
   0x0000555555555155 &lt;+12&gt;:    mov    rsi,rax
   ...
</code></pre><p>Esse &#xE9; o in&#xED;cio da fun&#xE7;&#xE3;o <code>main</code>. Note que &#xE9; subtra&#xED;do <code>0x10</code> do <code>rsp</code>, o que quer dizer que a stack ter&#xE1; 16 bytes (0x10 = 16) para vari&#xE1;veis.</p>
<p>Depois, a instru&#xE7;&#xE3;o <code>lea</code> carrega o endere&#xE7;o de <code>rbp-0x5</code> no <code>rax</code>. O <code>rax</code> &#xE9; s&#xF3; uma vari&#xE1;vel tempor&#xE1;ria, que passa o seu valor para <code>rsi</code>, que por sua vez &#xE9; o registrador utilizado como primeiro par&#xE2;metro de uma fun&#xE7;&#xE3;o. Isso tudo &#xE9; o preparo para chamar a fun&#xE7;&#xE3;o <code>scanf</code>, que usa o endere&#xE7;o guardado no <code>rsi</code> para atribuir o input do usu&#xE1;rio.</p>
<p>Opa! Nossa vari&#xE1;vel n&#xE3;o tinha tamanho 5? Vemos um <code>rbp-0x5</code> aqui. Exatamente, as coisas s&#xE3;o bem intuitivas. Acabamos de ver mem&#xF3;ria ser alocada na stack para receber uma string com 4 caracteres + byte nulo.</p>
<p>Se analisarmos no pwndbg, ap&#xF3;s darmos o input <code>John</code> temos na stack:</p>
<pre><code>&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;[ STACK ]&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;
00:0000&#x2502; rsp 0x7fffffffdd40 &#x25C2;&#x2014; 0
01:0008&#x2502;-008 0x7fffffffdd48 &#x25C2;&#x2014; 0x6e686f4affdde0
02:0010&#x2502; rbp 0x7fffffffdd50 &#x25C2;&#x2014; 1
03:0018&#x2502;+008 0x7fffffffdd58 &#x2014;&#x25B8; 0x7ffff7ddfca8 (__libc_start_call_main+120) &#x25C2;&#x2014; mov edi, eax
04:0020&#x2502;+010 0x7fffffffdd60 &#x2014;&#x25B8; 0x7fffffffde50 &#x2014;&#x25B8; 0x7fffffffde58 &#x25C2;&#x2014; 0x38 /* &apos;8&apos; */
05:0028&#x2502;+018 0x7fffffffdd68 &#x2014;&#x25B8; 0x555555555149 (main) &#x25C2;&#x2014; push rbp
06:0030&#x2502;+020 0x7fffffffdd70 &#x25C2;&#x2014; 0x155554040
07:0038&#x2502;+028 0x7fffffffdd78 &#x2014;&#x25B8; 0x7fffffffde68 &#x2014;&#x25B8; 0x7fffffffe148 &#x25C2;&#x2014; &apos;/mnt/c/Users/Ariel/Desktop/Manual-de-Engenharia-Reversa-Ganesh/test&apos;
</code></pre><p>Vemos que s&#xF3; h&#xE1; um valor na stack entre o <code>rbp</code> e <code>rsp</code>. Se analisarmos esse valor:</p>
<pre><code>0x6e686f4affdde0 = 
  6e 68 6f 4a ff dd e0
  n  h  o  J  [lixo de mem&#xF3;ria]
</code></pre><p>Na mem&#xF3;ria est&#xE1; sequencial, como veremos j&#xE1; j&#xE1;. Por&#xE9;m o GDB transforma isso em little endian (byte menos significativo primeiro), ou seja, inverte os bytes e mostra em um &#xFA;nico hexadecimal.</p>
<p>O lixo de mem&#xF3;ria aparece justamente porque porque o GDB est&#xE1; mostrando o conte&#xFA;do bruto da mem&#xF3;ria no endere&#xE7;o que voc&#xEA; examinou, n&#xE3;o interpretando como string. Na verdade, ele est&#xE1; analisando 8 bytes de mem&#xF3;ria, que &#xE9; o padr&#xE3;o. Por&#xE9;m, nossa vari&#xE1;vel ocupa apenas 5 bytes. Ent&#xE3;o sobram 3 bytes mesmo.</p>
<p>E dando <code>hexdump $rsp</code> para ver o bin&#xE1;rio da regi&#xE3;o da stack a partir do <code>rsp</code>, temos:</p>
<pre><code>+0000 0x7fffffffdd40  00 00 00 00 00 00 00 00  e0 dd ff 4a 6f 68 6e 00  &#x2502;........&#x2502;...John.&#x2502;
+0010 0x7fffffffdd50  01 00 00 00 00 00 00 00  a8 fc dd f7 ff 7f 00 00  &#x2502;........&#x2502;........&#x2502;
+0020 0x7fffffffdd60  50 de ff ff ff 7f 00 00  49 51 55 55 55 55 00 00  &#x2502;P.......&#x2502;IQUUUU..&#x2502;
+0030 0x7fffffffdd70  40 40 55 55 01 00 00 00  68 de ff ff ff 7f 00 00  &#x2502;@@UU....&#x2502;h.......&#x2502;
</code></pre><p>Na mem&#xF3;ria, as coisas est&#xE3;o alinhadas. Note que temos 4a 6f 68 6e 00. O &#xFA;ltimo caractere &#xE9; o null terminator (indica fim da string).</p>
<p>Agora, vem uma quest&#xE3;o. A vari&#xE1;vel suporta apenas 4 caracteres. O que ocorre se digitarmos 5?</p>
<pre><code>&lt; James
&gt; Voc&#xEA; digitou: James
</code></pre><p>Dando <code>hexdump $rsp</code>, temos:</p>
<pre><code> hexdump $rsp
+0000 0x7fffffffdd40  00 00 00 00 00 00 00 00  e0 dd ff 4a 61 6d 65 73  &#x2502;........&#x2502;...James&#x2502;
+0010 0x7fffffffdd50  00 00 00 00 00 00 00 00  a8 fc dd f7 ff 7f 00 00  &#x2502;........&#x2502;........&#x2502;
+0020 0x7fffffffdd60  50 de ff ff ff 7f 00 00  49 51 55 55 55 55 00 00  &#x2502;P.......&#x2502;IQUUUU..&#x2502;
+0030 0x7fffffffdd70  40 40 55 55 01 00 00 00  68 de ff ff ff 7f 00 00  &#x2502;@@UU....&#x2502;h.......&#x2502;
</code></pre><p>Veja, o <code>scanf</code> sobrescreveu a mem&#xF3;ria sem problemas. Mas agora o <code>\0</code> n&#xE3;o est&#xE1; mais l&#xE1;. Por sorte, os pr&#xF3;ximos bytes s&#xE3;o <code>00</code>. Portanto, <strong>o printf vai continuar lendo a string, mesmo que ela tenha passado o limite m&#xE1;ximo, pois ele depende de encontrar o \0 ou 00 para terminar</strong>. Isso &#xE9; uma falha de seguran&#xE7;a, pois permite vazar endere&#xE7;os de mem&#xF3;ria em um programa ao qual n&#xE3;o temos acesso ao bin&#xE1;rio (cenas dos pr&#xF3;ximos cap&#xED;tulos).</p>
<p>E se decidirmos colocar uma string gigante?</p>
<pre><code>&lt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
&gt; Voc&#xEA; digitou: James
</code></pre><p>Olhe s&#xF3; nossa stack agora:</p>
<pre><code>&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;[ STACK ]&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;
00:0000&#x2502; rsp 0x7fffffffdd40 &#x25C2;&#x2014; 0
01:0008&#x2502;-008 0x7fffffffdd48 &#x25C2;&#x2014; 0x4141414141ffdde0
02:0010&#x2502; rbp 0x7fffffffdd50 &#x25C2;&#x2014; &apos;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&apos;
... &#x2193;        5 skipped
</code></pre><p>Perceba que o endere&#xE7;o de <code>rbp</code> foi sobrescrito com um monte de A&apos;s. E se dermos um <code>hexdump $rsp</code>:</p>
<pre><code>hexdump $rsp

+0000 0x7fffffffdd40  00 00 00 00 00 00 00 00  e0 dd ff 41 41 41 41 41  &#x2502;........&#x2502;...AAAAA&#x2502;
+0010 0x7fffffffdd50  41 41 41 41 41 41 41 41  41 41 41 41 41 41 41 41  &#x2502;AAAAAAAA&#x2502;AAAAAAAA&#x2502;
... &#x2193;            skipped 1 identical lines (16 bytes)
+0030 0x7fffffffdd70  41 41 41 41 41 41 41 41  41 41 41 41 41 41 41 41  &#x2502;AAAAAAAA&#x2502;AAAAAAAA&#x2502;
</code></pre><p>Basicamente, acabamos de sobrescrever <code>0x7fffffffdd80 - 0x7fffffffdd4b = 0x35 = 53 (decimal)</code> Bytes (<code>0x7fffffffdd80</code> &#xE9; o endere&#xE7;o do &#xFA;ltimo byte com A. <code>0x7fffffffdd4b</code> &#xE9; a quantidade de elementos que n&#xE3;o s&#xE3;o <code>41</code>)! E olha s&#xF3;, digitamos A 53 vezes.</p>
<p>Okay, isso significa que podemos <strong>alterar o que quisermos na stack, desde a vari&#xE1;vel que permite o buffer overflow at&#xE9; depois do <code>rbp</code></strong>.</p>
<p>E o que acontece se tentarmos continuar o programa? Bom, n&#xE3;o h&#xE1; outras vari&#xE1;veis no programa, ent&#xE3;o nada foi sobrescrito. Mas <code>rbp</code> e o <code>return address</code> (<code>rbp+0x8</code> em <code>x64</code>) foram sobrescritos. Quando a fun&#xE7;&#xE3;o <code>main</code> terminar, ela vai tentar voltar a algum endere&#xE7;o que estava guardado no <code>return address</code>, mas que se perdeu, pois sobrescrevemos ele com <code>0x4141414141414141</code>. Por&#xE9;m, ainda assim, esse endere&#xE7;o vai tentar ser acessado. No fim do c&#xF3;digo em assembly, vemos:</p>
<pre><code>&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;[ DISASM / x86-64 / set emulate on ]&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;
   0x55555555517a &lt;main+49&gt;    mov    rdi, rax               RDI =&gt; 0x555555556007 &#x25C2;&#x2014; 0x696420aac3636f56
   0x55555555517d &lt;main+52&gt;    mov    eax, 0                 EAX =&gt; 0
   0x555555555182 &lt;main+57&gt;    call   printf@plt                  &lt;printf@plt&gt;

   0x555555555187 &lt;main+62&gt;    mov    eax, 0                 EAX =&gt; 0
   0x55555555518c &lt;main+67&gt;    leave
 &#x25BA; 0x55555555518d &lt;main+68&gt;    ret                                &lt;0x4141414141414141&gt;
</code></pre><p>Viu que a instru&#xE7;&#xE3;o <code>ret</code> tem o endere&#xE7;o <code>0x4141414141414141</code>? Se prosseguirmos com a execu&#xE7;&#xE3;o do programa....</p>
<pre><code>pwndbg&gt; c
Continuing.

Program received signal SIGSEGV, Segmentation fault.
</code></pre><p><strong>Segmentation fault</strong>! Por que? Pois o endere&#xE7;o de mem&#xF3;ria <code>0x4141414141414141</code>, n&#xE3;o deveria estar sendo acessado pelo programa, ou seja, &#xE9; uma &#xE1;rea de mem&#xF3;ria reservada de outro programa ou do sistema operacional.</p>
<p>O ponto principal do Buffer Overflow &#xE9; que, <strong>para um dado input, precisamos que o c&#xF3;digo leia mais caracteres do que a vari&#xE1;vel pode aguentar</strong>. Se no c&#xF3;digo h&#xE1; um limite de caracteres, isso faz com que Buffer Overflow <strong>n&#xE3;o seja uma t&#xE9;cnica poss&#xED;vel</strong>, e precisamos explorar outras possibiilidades.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="1_beginning.html" class="navigation navigation-prev " aria-label="Previous page: Pwning">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="2_1_bof_variables.html" class="navigation navigation-next " aria-label="Next page: Buffer Overflow - Variáveis">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Buffer Overflow","level":"1.3.1","depth":2,"next":{"title":"Buffer Overflow - Variáveis","level":"1.3.1.1","depth":3,"path":"pwning/2_1_bof_variables.md","ref":"./pwning/2_1_bof_variables.md","articles":[]},"previous":{"title":"Pwning","level":"1.3","depth":1,"path":"pwning/1_beginning.md","ref":"./pwning/1_beginning.md","articles":[{"title":"Buffer Overflow","level":"1.3.1","depth":2,"path":"pwning/2_0_bof.md","ref":"./pwning/2_0_bof.md","articles":[{"title":"Buffer Overflow - Variáveis","level":"1.3.1.1","depth":3,"path":"pwning/2_1_bof_variables.md","ref":"./pwning/2_1_bof_variables.md","articles":[]},{"title":"Buffer Overflow - CallFunction","level":"1.3.1.2","depth":3,"path":"pwning/2_2_bof_callfunction.md","ref":"./pwning/2_2_bof_callfunction.md","articles":[]},{"title":"Buffer Overflow - ShellCode","level":"1.3.1.3","depth":3,"path":"pwning/2_3_bof_shellcode.md","ref":"./pwning/2_3_bof_shellcode.md","articles":[]},{"title":"Format Strings","level":"1.3.1.4","depth":3,"path":"pwning/3_format_strings.md","ref":"./pwning/3_format_strings.md","articles":[]},{"title":"Array Indexing","level":"1.3.1.5","depth":3,"path":"pwning/4_array_indexing.md","ref":"./pwning/4_array_indexing.md","articles":[]},{"title":"Integer Overflow","level":"1.3.1.6","depth":3,"path":"pwning/5_integer_overflow.md","ref":"./pwning/5_integer_overflow.md","articles":[]},{"title":"Bad seed","level":"1.3.1.7","depth":3,"path":"pwning/6_bad_seed.md","ref":"./pwning/6_bad_seed.md","articles":[]}]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"pwning/2_0_bof.md","mtime":"2025-12-18T20:48:58.896Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-12-21T02:45:52.953Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

