
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Buffer Overflow - CallFunction · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="2_3_bof_shellcode.html" />
    
    
    <link rel="prev" href="2_1_bof_variables.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Bem vindo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/1_beginning.html">
            
                <a href="../introduction/1_beginning.html">
            
                    
                    Introdução ao Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../introduction/2_assembly.html">
            
                <a href="../introduction/2_assembly.html">
            
                    
                    Assembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../introduction/3_endianness.html">
            
                <a href="../introduction/3_endianness.html">
            
                    
                    Endianness
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../introduction/4_ghidra.html">
            
                <a href="../introduction/4_ghidra.html">
            
                    
                    Ghidra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../introduction/5_gdb.html">
            
                <a href="../introduction/5_gdb.html">
            
                    
                    GDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../introduction/6_pwntools.html">
            
                <a href="../introduction/6_pwntools.html">
            
                    
                    Pwntools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="1_beginning.html">
            
                <a href="1_beginning.html">
            
                    
                    Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="2_0_bof.html">
            
                <a href="2_0_bof.html">
            
                    
                    Buffer Overflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="2_1_bof_variables.html">
            
                <a href="2_1_bof_variables.html">
            
                    
                    Buffer Overflow - Variáveis
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.1.2" data-path="2_2_bof_callfunction.html">
            
                <a href="2_2_bof_callfunction.html">
            
                    
                    Buffer Overflow - CallFunction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="2_3_bof_shellcode.html">
            
                <a href="2_3_bof_shellcode.html">
            
                    
                    Buffer Overflow - ShellCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="3_format_strings.html">
            
                <a href="3_format_strings.html">
            
                    
                    Format Strings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../fast_food/beginning.html">
            
                <a href="../fast_food/beginning.html">
            
                    
                    Fast Food
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../fast_food/introduction/1_beggining.html">
            
                <a href="../fast_food/introduction/1_beggining.html">
            
                    
                    Fast Intro
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../fast_food/introduction/2_assembly.html">
            
                <a href="../fast_food/introduction/2_assembly.html">
            
                    
                    Assembly CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../fast_food/introduction/3_endianness.html">
            
                <a href="../fast_food/introduction/3_endianness.html">
            
                    
                    Endianness
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../fast_food/introduction/4_ghidra.html">
            
                <a href="../fast_food/introduction/4_ghidra.html">
            
                    
                    Ghidra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../fast_food/introduction/5_gdb.html">
            
                <a href="../fast_food/introduction/5_gdb.html">
            
                    
                    GDB CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../fast_food/introduction/6_pwntools.html">
            
                <a href="../fast_food/introduction/6_pwntools.html">
            
                    
                    Pwntools CheatSheet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="1_beginning.html">
            
                <a href="1_beginning.html">
            
                    
                    Fast Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../fast_food/pwning/2_protections.html">
            
                <a href="../fast_food/pwning/2_protections.html">
            
                    
                    Proteções de binários
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../fast_food/pwning/3_bof.html">
            
                <a href="../fast_food/pwning/3_bof.html">
            
                    
                    Buffer Overflow Simples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../fast_food/pwning/4_bof_callfunction.html">
            
                <a href="../fast_food/pwning/4_bof_callfunction.html">
            
                    
                    Buffer Overflow - Variáveis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../fast_food/pwning/5_bof_shellcode.html">
            
                <a href="../fast_food/pwning/5_bof_shellcode.html">
            
                    
                    Buffer Overflow - ShellCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../fast_food/pwning/6_format_strings.html">
            
                <a href="../fast_food/pwning/6_format_strings.html">
            
                    
                    Format Strings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Buffer Overflow - CallFunction</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="23-buffer-overflow---call-function">2.3 Buffer Overflow - Call Function</h2>
<p>Na stack, vimos que h&#xE1; um endere&#xE7;o de retorno. Em <code>x64</code>, esse endere&#xE7;o de retorno fica em <code>rbp+0x8</code>. Em <code>x32</code>, esse endere&#xE7;o de retorno fica em <code>ebp+0x4</code>.</p>
<p>Sempre que uma fun&#xE7;&#xE3;o chega ao final, ela chama a instru&#xE7;&#xE3;o <code>ret</code>, que desempilha esse endere&#xE7;o de retorno, extrai o endere&#xE7;o que est&#xE1; ali guardado, e atribui ao <code>rip</code>, de modo que o programa come&#xE7;a a ler instru&#xE7;&#xF5;es a partir daquele endere&#xE7;o.</p>
<p>Podemos utilizar Buffer Overflow para <strong>sobrescrever esse endere&#xE7;o de retorno e ir para o lugar que quisermos no c&#xF3;digo</strong>. Sim, podemos chamar qualquer fun&#xE7;&#xE3;o, mesmo que ela nunca seja chamada no c&#xF3;digo (ela s&#xF3; precisa existir).</p>
<p>Para fazer um Buffer Overflow Call Function:</p>
<ol>
<li>Verifique informa&#xE7;&#xF5;es do arquivo com <code>file arquivo</code></li>
<li>Abra o programa no Ghidra ou Debugger</li>
<li><strong>Calcule a dist&#xE2;ncia entre o in&#xED;cio do input e do endere&#xE7;o de retorno</strong> <code>rbp+0x8</code> (x64) ou <code>ebp+0x4</code> (x32)<ol>
<li>Ex: Se a vari&#xE1;vel est&#xE1; em <code>rbp-0x10</code>, a dist&#xE2;ncia &#xE9; <code>0x10 + 0x8 = 0x18</code>.</li>
</ol>
</li>
<li>Em uma string, coloque caracteres para preencher essa dist&#xE2;ncia. Ao final, <strong>adicione o endere&#xE7;o de algum lugar do programa</strong>.</li>
</ol>
<p>Para obter endere&#xE7;os, &#xE9; recomend&#xE1;vel <strong>usar o Ghidra para explorar outras fun&#xE7;&#xF5;es que podem existir no arquivo</strong>. Mas h&#xE1; um por&#xE9;m. Existe uma seguran&#xE7;a implementada por padr&#xE3;o que &#xE9; a <strong>randomiza&#xE7;&#xE3;o de mem&#xF3;ria</strong>. Toda vez que um programa roda, essa seguran&#xE7;a pega endere&#xE7;os aleat&#xF3;rios de mem&#xF3;ria RAM. Assim, mesmo que voc&#xEA; tente um endere&#xE7;o que viu no Ghidra, n&#xE3;o ir&#xE1; funcionar, pois outro endere&#xE7;o &#xE9; que est&#xE1; ativo.</p>
<p>Para vencer esse obst&#xE1;culo, voc&#xEA; teria que vazar um endere&#xE7;o de mem&#xF3;ria, como vimos que pode ser feito tirando o \0 do fim da string. Mas isso &#xE9; muito mais limitado do que navegar pelo Ghidra e achar a fun&#xE7;&#xE3;o com o endere&#xE7;o certinho.</p>
<p>Nesses desafios, essa prote&#xE7;&#xE3;o est&#xE1; desativada, e voc&#xEA; pode apenas copiar e colar os endere&#xE7;os. Mais adiante abordaremos sobre isso.</p>
<h3 id="231-cuidado-ao-sobrescrever-return-address-desalinhamento-de-stack">2.3.1 Cuidado ao sobrescrever Return Address: Desalinhamento de Stack</h3>
<p>Existem algumas fun&#xE7;&#xF5;es importantes que utilizam instru&#xE7;&#xF5;es que exigem que a Stack esteja alinhada, como, por exemplo, a fun&#xE7;&#xE3;o <code>system(&quot;./bin/sh&quot;)</code>. Se seu objetivo for chamar uma fun&#xE7;&#xE3;o que tenha essa fun&#xE7;&#xE3;o dentro, o programa vai resultar em falha de segmenta&#xE7;&#xE3;o.</p>
<p>Para <code>x64</code>, a stack deve ter o tamanho sempre de um m&#xFA;ltiplo de <code>16 bytes</code> antes de uma chamada de fun&#xE7;&#xE3;o <code>call</code>. Para <code>x86</code>, n&#xE3;o h&#xE1; requisito r&#xED;gido pr&#xE9;-chamada.</p>
<p>Em particular, instru&#xE7;&#xF5;es SSE exigem <code>[rsp] % 16 == 0</code></p>
<pre><code>; Instru&#xE7;&#xE3;o SSE
movaps xmm0, [rsp]    ; &#x26A0;&#xFE0F; CRASH se [rsp] n&#xE3;o for m&#xFA;ltiplo de 16
</code></pre><p>Vamos verificar alinhamento de stack para <code>x64</code>, onde realmente isso pode causar problemas.</p>
<p>Se n&#xE3;o estiv&#xE9;ssemos fazendo o BOF para chamar uma fun&#xE7;&#xE3;o, o programa seguiria um padr&#xE3;o de instru&#xE7;&#xF5;es: </p>
<ul>
<li><code>call funcao</code> - <code>PUSH RIP</code> (<code>RSP = RSP - 8</code>) e <code>JMP 0xfuncaoaddr</code> (+8 bytes na stack) // <strong>Desalinha</strong> (8 bytes)</li>
<li><code>inicio_funcao</code> - <code>PUSH RBP</code> (<code>RSP = RSP - 8</code>) (+8 bytes na stack) // <strong>Alinha</strong> (16 bytes)</li>
</ul>
<p>Isso resulta em uma stack alinhada.</p>
<p>Mas como estamos sobrescrevendo o Return Address para irmos ao lugar que quisermos, n&#xE3;o existe call, e sim uma modifica&#xE7;&#xE3;o do que se faz ap&#xF3;s <code>leave</code> e <code>ret</code> na fun&#xE7;&#xE3;o original (<code>main</code>). Segue o fluxo:</p>
<ul>
<li><code>leave</code> - <code>MOV RSP, RBP</code>; <code>POP RBP</code> (<code>RSP = RSP + 8</code>) (-8 bytes na stack) // <strong>Desalinha</strong> (-8 bytes)</li>
<li><code>ret</code> - <code>POP RIP</code> (<code>RSP = RSP + 8</code>) (-8 bytes na stack) // <strong>Alinha</strong> (-16 bytes)</li>
<li><code>inicio_funcao</code> - <code>PUSH RBP</code> (<code>RSP = RSP - 8</code>) (+8 bytes na stack) // <strong>Desalinha</strong> (-8 bytes)</li>
</ul>
<p>Isso vai resultar em <strong>SEGSV (Segmentation Fault)</strong>, e o programa vai crashar.</p>
<p><strong>Como evitar desalinhamento de stack</strong>? H&#xE1; duas maneiras.</p>
<h4 id="1&#xB0;---evitando-push-rbp">1&#xB0; - Evitando PUSH RBP</h4>
<p>Suponha que a fun&#xE7;&#xE3;o para a qual queremos pular est&#xE1; em <code>0x00000001</code>. A instru&#xE7;&#xE3;o PUSH RBP ocupa 1 byte de mem&#xF3;ria. Portanto, para pular para a pr&#xF3;xima, basta usar o endere&#xE7;o <code>0x00000002</code>.</p>
<pre><code class="lang-py">target_address = <span class="hljs-number">0x401234</span> + <span class="hljs-number">1</span>  <span class="hljs-comment"># Pula o push rbp</span>
</code></pre>
<p>Ou voc&#xEA; pode verificar o endere&#xE7;o da pr&#xF3;xima instru&#xE7;&#xE3;o ao PUSH RBP no decompilador ou gdb.</p>
<h4 id="2&#xB0;---rop-com-ret">2&#xB0; - ROP com ret</h4>
<p>Essa t&#xE9;cnica &#xE9; mais confi&#xE1;vel e robusta. <strong>ROP (Return Oriented Programming) &#xE9; uma t&#xE9;cnica de explora&#xE7;&#xE3;o que usa peda&#xE7;os de c&#xF3;digos j&#xE1; existentes no programa (gadgets) para executar c&#xF3;digo malicioso</strong>.</p>
<p>Basicamente, vamos <strong>achar o endere&#xE7;o na mem&#xF3;ria de uma instru&#xE7;&#xE3;o</strong> <code>ret</code>, um <strong>gadget</strong>. Isso s&#xF3; &#xE9; poss&#xED;vel <strong>se a prote&#xE7;&#xE3;o PIE n&#xE3;o estiver ativada</strong> (randomiza&#xE7;&#xE3;o de mem&#xF3;ria),</p>
<h5 id="buscando-gadget">Buscando gadget</h5>
<p>Podemos usar o comando Linux (deve ser instalado) <code>ROPgadget</code>: <code>ROPgadget -- binary meu_programa | grep &quot;ret&quot;</code>.</p>
<p>Tamb&#xE9;m podemos usar <strong>pwntools</strong>: </p>
<pre><code class="lang-py"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *

elf = ELF(<span class="hljs-string">&apos;./vuln&apos;</span>)
rop = ROP(elf)

<span class="hljs-comment"># Encontra gadgets ret</span>
ret_gadgets = rop.find_gadget([<span class="hljs-string">&apos;ret&apos;</span>])
print(f<span class="hljs-string">&quot;Ret gadget: {hex(ret_gadgets.address)}&quot;</span>) <span class="hljs-comment"># Imprime endere&#xE7;o do gadget</span>
</code></pre>
<p>Assim, podemos montar nosso payload.</p>
<p>Mas, antes de usarmos esse <code>ret</code>, vamos entender por que ele funciona.</p>
<h5 id="por-que-ret">Por que <code>ret</code>?</h5>
<p>No <strong>fim de uma fun&#xE7;&#xE3;o qualquer</strong>, sempre teremos as instru&#xE7;&#xF5;es:</p>
<pre><code>0x0000000000401208 &lt;+124&gt;:   leave
0x0000000000401209 &lt;+125&gt;:   ret
</code></pre><ul>
<li><code>leave</code> - Comando compacto:<ul>
<li><code>MOV RSP, RBP</code> - <code>RBP</code> &#xE9; copiado para <code>RSP</code>. Isso destr&#xF3;i o stack frame da fun&#xE7;&#xE3;o, descartando todas as vari&#xE1;veis locais. (agora, o pr&#xF3;ximo da stack &#xE9; o <code>RBP</code> antigo)</li>
<li><code>POP RBP</code> - O valor no topo da pilha (<code>RBP</code> antigo) &#xE9; desempilhado para o registrador <code>RBP</code>. Isso faz o stack frame &quot;voltar para tr&#xE1;s&quot;. (agora, o pr&#xF3;ximo da stack &#xE9; o <code>return address</code>)</li>
</ul>
</li>
<li><code>ret</code> - Comando compacto:<ul>
<li><code>POP RIP</code> - O valor no topo da pilha (apontado pelo <code>RSP</code>) agora &#xE9; <code>RBP+8</code>, o <code>return address</code> que tentamos sobrescrever. Como <code>RIP</code> &#xE9; o registrador que indica a instru&#xE7;&#xE3;o atual ativa, estamos fazendo o programa &quot;pular&quot; para um endere&#xE7;o de mem&#xF3;ria salvo em <code>RBP+8</code>.</li>
</ul>
</li>
</ul>
<p>Esse &#xE9; o fluxo normal de sair de uma fun&#xE7;&#xE3;o e ir para outra. Isso deixa a stack alinhada. O efeito que o <code>ret</code> tem &#xE9; de <strong>tirar 8 bytes da stack</strong>.</p>
<pre><code>No assembly:

[RBP-0x20] = AAAA...          (bytes de padding)
[RBP+0x00] = RBP antigo        (8 bytes) &lt;- RSP = RBP
[RBP+0x08] = RET gadget        &#x2190; RIP vai aqui
...
No RIP:
0x00000000ff ret -&gt; Efeito: POP RIP (tira 8 bytes da stack)
</code></pre><p>Se sobrescrevemos o <code>return address</code> com um endere&#xE7;o de um local do c&#xF3;digo com <code>ret</code>, teremos o seguinte fluxo:</p>
<ul>
<li><code>leave</code> - Comando compacto:<ul>
<li><code>MOV RSP, RBP</code> - <code>RBP</code> &#xE9; copiado para <code>RSP</code>. Isso destr&#xF3;i o stack frame da fun&#xE7;&#xE3;o, descartando todas as vari&#xE1;veis locais. (agora, o pr&#xF3;ximo da stack &#xE9; o <code>RBP</code> antigo)</li>
<li><code>POP RBP</code> - O valor no topo da pilha (<code>RBP</code> antigo) &#xE9; desempilhado para o registrador <code>RBP</code>. Isso faz o stack frame &quot;voltar para tr&#xE1;s&quot;. (agora, o pr&#xF3;ximo da stack &#xE9; o <code>return address</code>)</li>
</ul>
</li>
<li><code>ret</code> - Comando compacto:<ul>
<li><code>POP RIP</code> - O valor no topo da pilha (apontado pelo <code>RSP</code>) agora &#xE9; <code>RBP+0x8</code>, o <code>return address</code> que cont&#xE9;m o ROP. Pulamos para um endere&#xE7;o de mem&#xF3;ria salvo em <code>RBP+8</code>.</li>
</ul>
</li>
<li>Somos levados a uma instru&#xE7;&#xE3;o <code>ret</code> novamente, que interage com a stack.</li>
<li><code>ret</code> - Comando compacto:<ul>
<li><code>POP RIP</code> - O valor no topo da pilha (apontado pelo <code>RSP</code>) agora &#xE9; <code>RBP+0x10</code>, o <code>return address</code> que tentamos sobrescrever. Pulamos para um endere&#xE7;o de mem&#xF3;ria salvo em <code>RBP+0x10</code>, que &#xE9; nossa fun&#xE7;&#xE3;o.</li>
</ul>
</li>
</ul>
<p>Assim, teremos a seguinte stack ap&#xF3;s um overflow:</p>
<pre><code>[RBP-0x20] = AAAA...          (bytes de padding)
[RBP+0x00] = RBP antigo        (8 bytes) 
[RBP+0x08] = RET gadget        &#x2190; RIP vai aqui primeiro!
[RBP+0x10] = Fun&#xE7;&#xE3;o alvo       &#x2190; RIP vai aqui depois!
</code></pre><p>E:</p>
<ul>
<li><code>leave</code> - <code>MOV RSP, RBP</code>; <code>POP RBP</code> (<code>RSP = RSP + 8</code>) (-8 bytes na stack) // <strong>Desalinha</strong> (-8 bytes)</li>
<li><code>ret</code> - <code>POP RIP</code> (<code>RSP = RSP + 8</code>) (-8 bytes na stack) // <strong>Alinha</strong> (-16 bytes)</li>
<li>Agora, o <code>ret</code> leva a um lugar que n&#xE3;o era para levar (manipulado por n&#xF3;s)</li>
<li><code>ret</code> - <code>POP RIP</code> (<code>RSP = RSP + 16</code>) (-8 bytes na stack) // <strong>Alinha</strong> (-24 bytes)</li>
<li><code>inicio_funcao</code> - <code>PUSH RBP</code> (<code>RSP = RSP - 8</code>) (+8 bytes na stack) // <strong>Desalinha</strong> (-16 bytes)</li>
</ul>
<p>Veja, alinhamos com 16 bytes agora.</p>
<h5 id="c&#xF3;digo-em-pwntools">C&#xF3;digo em pwntools</h5>
<pre><code class="lang-py">
<span class="hljs-comment"># Acha gadget</span>
elf = ELF(<span class="hljs-string">&apos;./vuln&apos;</span>)
rop = ROP(elf)
ret = rop.find_gadget([<span class="hljs-string">&apos;ret&apos;</span>])

<span class="hljs-comment"># Alinha com ret e entra na fun&#xE7;&#xE3;o</span>
payload = <span class="hljs-string">b&apos;A&apos;</span> * <span class="hljs-number">40</span>
payload += p64(ret)
payload += p64(func_addr)
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="2_1_bof_variables.html" class="navigation navigation-prev " aria-label="Previous page: Buffer Overflow - Variáveis">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="2_3_bof_shellcode.html" class="navigation navigation-next " aria-label="Next page: Buffer Overflow - ShellCode">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Buffer Overflow - CallFunction","level":"1.3.1.2","depth":3,"next":{"title":"Buffer Overflow - ShellCode","level":"1.3.1.3","depth":3,"path":"pwning/2_3_bof_shellcode.md","ref":"./pwning/2_3_bof_shellcode.md","articles":[]},"previous":{"title":"Buffer Overflow - Variáveis","level":"1.3.1.1","depth":3,"path":"pwning/2_1_bof_variables.md","ref":"./pwning/2_1_bof_variables.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"pwning/2_2_bof_callfunction.md","mtime":"2025-12-18T20:49:13.600Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-12-19T13:17:28.477Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

