
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>GDB · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="6_pwntools.html" />
    
    
    <link rel="prev" href="4_ghidra.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Bem vindo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="1_beginning.html">
            
                <a href="1_beginning.html">
            
                    
                    Introdução ao Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="2_assembly.html">
            
                <a href="2_assembly.html">
            
                    
                    Assembly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="3_endianness.html">
            
                <a href="3_endianness.html">
            
                    
                    Endianness
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="4_ghidra.html">
            
                <a href="4_ghidra.html">
            
                    
                    Ghidra
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.4" data-path="5_gdb.html">
            
                <a href="5_gdb.html">
            
                    
                    GDB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="6_pwntools.html">
            
                <a href="6_pwntools.html">
            
                    
                    Pwntools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../pwning/1_beginning.html">
            
                <a href="../pwning/1_beginning.html">
            
                    
                    Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../pwning/2_0_bof.html">
            
                <a href="../pwning/2_0_bof.html">
            
                    
                    Buffer Overflow
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../pwning/2_1_bof_variables.html">
            
                <a href="../pwning/2_1_bof_variables.html">
            
                    
                    Buffer Overflow - Variáveis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../pwning/2_2_bof_callfunction.html">
            
                <a href="../pwning/2_2_bof_callfunction.html">
            
                    
                    Buffer Overflow - CallFunction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.3" data-path="../pwning/2_3_bof_shellcode.html">
            
                <a href="../pwning/2_3_bof_shellcode.html">
            
                    
                    Buffer Overflow - ShellCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.4" data-path="../pwning/3_format_strings.html">
            
                <a href="../pwning/3_format_strings.html">
            
                    
                    Format Strings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.5" data-path="../pwning/4_array_indexing.html">
            
                <a href="../pwning/4_array_indexing.html">
            
                    
                    Array Indexing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.6" data-path="../pwning/5_integer_overflow.html">
            
                <a href="../pwning/5_integer_overflow.html">
            
                    
                    Integer Overflow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.7" data-path="../pwning/6_bad_seed.html">
            
                <a href="../pwning/6_bad_seed.html">
            
                    
                    Bad seed
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../fast_food/beginning.html">
            
                <a href="../fast_food/beginning.html">
            
                    
                    Fast Food
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../fast_food/introduction/1_beggining.html">
            
                <a href="../fast_food/introduction/1_beggining.html">
            
                    
                    Fast Intro
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../fast_food/introduction/2_assembly.html">
            
                <a href="../fast_food/introduction/2_assembly.html">
            
                    
                    Assembly CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../fast_food/introduction/3_endianness.html">
            
                <a href="../fast_food/introduction/3_endianness.html">
            
                    
                    Endianness
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../fast_food/introduction/4_ghidra.html">
            
                <a href="../fast_food/introduction/4_ghidra.html">
            
                    
                    Ghidra
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="../fast_food/introduction/5_gdb.html">
            
                <a href="../fast_food/introduction/5_gdb.html">
            
                    
                    GDB CheatSheet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.5" data-path="../fast_food/introduction/6_pwntools.html">
            
                <a href="../fast_food/introduction/6_pwntools.html">
            
                    
                    Pwntools CheatSheet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../pwning/1_beginning.html">
            
                <a href="../pwning/1_beginning.html">
            
                    
                    Fast Pwning
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../fast_food/pwning/2_protections.html">
            
                <a href="../fast_food/pwning/2_protections.html">
            
                    
                    Proteções de binários
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../fast_food/pwning/3_bof.html">
            
                <a href="../fast_food/pwning/3_bof.html">
            
                    
                    Buffer Overflow - Variáveis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../fast_food/pwning/4_bof_callfunction.html">
            
                <a href="../fast_food/pwning/4_bof_callfunction.html">
            
                    
                    Buffer Overflow - CallFunction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../fast_food/pwning/5_bof_shellcode.html">
            
                <a href="../fast_food/pwning/5_bof_shellcode.html">
            
                    
                    Buffer Overflow - ShellCode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../fast_food/pwning/6_format_strings.html">
            
                <a href="../fast_food/pwning/6_format_strings.html">
            
                    
                    Format Strings
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >GDB</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="5-debugging-com-gdb">5. Debugging com GDB</h1>
<p>GDB, um debbuger do GNU, &#xE9; uma &#xF3;tima ferramenta para <strong>analisar bin&#xE1;rios em execu&#xE7;&#xE3;o</strong>, permitindo analisar o c&#xF3;digo em assembly, ler vari&#xE1;veis na mem&#xF3;ria, ler a stack, etc. &#xC9; realmente essencial para se trabalhar com rev.</p>
<p>Normalmente, o combo &#xE9; Ghidra + GDB: Abra o Ghidra para ter uma ideia do que o c&#xF3;digo faz e use o GDB para tentar explorar as vulnerabilidades e analisar o bin&#xE1;rio em execu&#xE7;&#xE3;o.</p>
<h2 id="51-instalando-e-executando">5.1 Instalando e executando</h2>
<p>H&#xE1; tr&#xEA;s vers&#xF5;es do <code>gdb</code>. O <code>gdb</code> cl&#xE1;ssico j&#xE1; vem instalado junto com o compilador do C ou C++. </p>
<p>O <code>gdb-gef</code> (gdb enhanced features), por sua vez, extende as funcionalidades do  <code>gdb</code> padr&#xE3;o, e &#xE9; muito mais &#xFA;til para an&#xE1;lise de software por engenharia reversa. Essa &#xE9; a vers&#xE3;o utilizado no tutorial do nightmare, por isso abordei ela aqui. O reposit&#xF3;rio do projeto pode ser encontrado <a href="https://github.com/hugsy/gef" target="_blank">aqui</a>.</p>
<p>O reposit&#xF3;rio do gdb-ged est&#xE1; em: <a href=""></a></p>
<p>Baixe o <code>gdb-gef</code> com: <code>bash -c &quot;$(wget https://gef.blah.cat/sh -O -)&quot;</code></p>
<p>E execute com: <code>gdb ./meu_binario</code></p>
<p>J&#xE1; a terceira vers&#xE3;o &#xE9; o <code>pwndbg</code>, que provavelmente &#xE9; a melhor das tr&#xEA;s, e a mais completa. O reposit&#xF3;rio do <code>pwndbg</code> pode ser encontrado <a href="https://github.com/pwndbg/pwndbg?tab=readme-ov-file" target="_blank">aqui</a>.</p>
<p>Baixe o <code>pwndbg-gdb</code> com: <code>curl -qsL &apos;https://install.pwndbg.re&apos; | sh -s -- -t pwndbg-gdb</code></p>
<p>E execute com: <code>pwndbg ./meu_binario</code></p>
<h2 id="52-como-usar">5.2 Como usar</h2>
<p>O intuito do GDB &#xE9; parar a execu&#xE7;&#xE3;o do programa em certos lugares, analisar e prosseguir.</p>
<p>Para navegar na execu&#xE7;&#xE3;o do programa no GDB:</p>
<ul>
<li><code>continue</code> -  Para somente em breakpoints e no fim do programa</li>
<li><code>next</code> - Linha por linha, mas pula chamadas de fun&#xE7;&#xE3;o como puts</li>
<li><code>step</code>  - Linha por linha, mas entra em chamadas de fun&#xE7;&#xE3;o</li>
<li><code>stepi</code>  - Instru&#xE7;&#xE3;o por instru&#xE7;&#xE3;o, entrando em chamadas de fun&#xE7;&#xE3;o</li>
</ul>
<p>Para ver uma fun&#xE7;&#xE3;o em assembly, digite <code>disassemble</code> (ou <code>disass</code>) mais o nome da fun&#xE7;&#xE3;o. Vamos dar um disassemble (ou seja, ver o c&#xF3;digo em assembly) da main:</p>
<ul>
<li><code>disass main</code></li>
</ul>
<pre><code class="lang-nasm">gef&#x27A4;  disass main
Dump of assembler code for function main:
   0x080483fb &lt;+0&gt;:    lea    ecx,[esp+0x4]
   0x080483ff &lt;+4&gt;:    and    esp,0xfffffff0
   0x08048402 &lt;+7&gt;:    push   DWORD PTR [ecx-0x4]
   0x08048405 &lt;+10&gt;:    push   ebp
   0x08048406 &lt;+11&gt;:    mov    ebp,esp
   0x08048408 &lt;+13&gt;:    push   ecx
   0x08048409 &lt;+14&gt;:    sub    esp,0x4
   0x0804840c &lt;+17&gt;:    sub    esp,0xc
   0x0804840f &lt;+20&gt;:    push   0x80484b0
   0x08048414 &lt;+25&gt;:    call   0x80482d0 &lt;puts@plt&gt;
   0x08048419 &lt;+30&gt;:    add    esp,0x10
   0x0804841c &lt;+33&gt;:    mov    eax,0x0
   0x08048421 &lt;+38&gt;:    mov    ecx,DWORD PTR [ebp-0x4]
   0x08048424 &lt;+41&gt;:    leave  
   0x08048425 &lt;+42&gt;:    lea    esp,[ecx-0x4]
   0x08048428 &lt;+45&gt;:    ret    
End of assembler dump.
</code></pre>
<h3 id="521-breakpoints">5.2.1 Breakpoints</h3>
<p>No GDB podemos usar breakpoints, que s&#xE3;o lugares onde o GDB <strong>para a execu&#xE7;&#xE3;o</strong> para permitir examinar o programa. O mais comum &#xE9; colocarmos o <strong>primeiro breakpoint na main</strong> (a fun&#xE7;&#xE3;o principal que cont&#xE9;m todo o c&#xF3;digo fonte). Podemos colocar <code>break main</code>  ou <code>b main</code> .</p>
<p>Agora, suponha que queremos dar um break na call do puts (fun&#xE7;&#xE3;o que imprime texto na tela), podemos fazer isso colocando um breakpoint para a instru&#xE7;&#xE3;o:</p>
<ul>
<li><code>b *main+25</code> (+25 &#xE9; relativo ao in&#xED;cio do c&#xF3;digo) ou <code>b *0x08048414</code> (endere&#xE7;o de mem&#xF3;ria da instru&#xE7;&#xE3;o)</li>
</ul>
<p><strong>Ainda n&#xE3;o rodamos o bin&#xE1;rio</strong>, apenas estabelecemos onde o GDB deve parar para que possamos analisar o c&#xF3;digo. Quando rodarmos o bin&#xE1;rio, o processo vai pausar e mostrar o debugger exatamente na instru&#xE7;&#xE3;o assembly onde colocamos os breakpoints (quando colocamos um breakpoint em uma fun&#xE7;&#xE3;o, paramos exatamente na primeira instru&#xE7;&#xE3;o dela).</p>
<p>Para <strong>executar o c&#xF3;digo desde o come&#xE7;o</strong>, execute <code>run</code> (ou <code>r</code>). Isso vai parar no primeiro breakpoint. Para <strong>prosseguir</strong>, execute <code>continue</code> (ou <code>c</code>). Esse comando continua a execu&#xE7;&#xE3;o at&#xE9; encontrar um breakpoint, fim do programa ou sinal (como segfault).</p>
<p>Para mostrar os breakpoints que colocamos:</p>
<ul>
<li><code>info breakpoints</code></li>
</ul>
<p>Para deletar um breakpoint:</p>
<ul>
<li><p><code>delete 2</code>  ou <code>d 2</code></p>
<p>Podemos colocar breakpoints em fun&#xE7;&#xF5;es como <code>puts</code> :</p>
</li>
<li><p><code>b *puts</code> (* significa endere&#xE7;o)  e <code>run</code></p>
</li>
</ul>
<h3 id="522-console-de-debug">5.2.2 Console de debug</h3>
<p>Quando rodamos o bin&#xE1;rio com <code>run</code> e o GDB tenta executar a instru&#xE7;&#xE3;o na qual colocamos o break, o processo vai pausar e dropar na ela o <strong>console de debug</strong>:</p>
<pre><code class="lang-nasm">gef&#x27A4;  r
Starting program: /home/devey/nightmare/modules/02-intro_tooling/hello_world 
[ Legend: Modified register | Code | Heap | Stack | String ]
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; registers &#x2500;&#x2500;&#x2500;&#x2500;
$eax   : 0xf7fb9dd8  &#x2192;  0xffffd19c  &#x2192;  0xffffd389  &#x2192;  &quot;CLUTTER_IM_MODULE=xim&quot;
$ebx   : 0x0       
$ecx   : 0xffffd100  &#x2192;  0x00000001
$edx   : 0xffffd124  &#x2192;  0x00000000
$esp   : 0xffffd0d0  &#x2192;  0x080484b0  &#x2192;  &quot;hello world!&quot;
$ebp   : 0xffffd0e8  &#x2192;  0x00000000
$esi   : 0xf7fb8000  &#x2192;  0x001d4d6c
$edi   : 0x0       
$eip   : 0x08048414  &#x2192;  0xfffeb7e8  &#x2192;  0x00000000
$eflags: [zero carry PARITY ADJUST SIGN trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x0023 $ss: 0x002b $ds: 0x002b $es: 0x002b $fs: 0x0000 $gs: 0x0063 
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; stack &#x2500;&#x2500;&#x2500;&#x2500;
0xffffd0d0&#x2502;+0x0000: 0x080484b0  &#x2192;  &quot;hello world!&quot;     &#x2190; $esp
0xffffd0d4&#x2502;+0x0004: 0xffffd194  &#x2192;  0xffffd34e  &#x2192;  &quot;/home/devey/nightmare/modules/02-intro_tooling/hel[...]&quot;
0xffffd0d8&#x2502;+0x0008: 0xffffd19c  &#x2192;  0xffffd389  &#x2192;  &quot;CLUTTER_IM_MODULE=xim&quot;
0xffffd0dc&#x2502;+0x000c: 0x08048451  &#x2192;  &lt;__libc_csu_init+33&gt; lea eax, [ebx-0xf8]
0xffffd0e0&#x2502;+0x0010: 0xf7fe59b0  &#x2192;   push ebp
0xffffd0e4&#x2502;+0x0014: 0xffffd100  &#x2192;  0x00000001
0xffffd0e8&#x2502;+0x0018: 0x00000000     &#x2190; $ebp
0xffffd0ec&#x2502;+0x001c: 0xf7dfbe81  &#x2192;  &lt;__libc_start_main+241&gt; add esp, 0x10
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; code:x86:32 &#x2500;&#x2500;&#x2500;&#x2500;
    0x8048409 &lt;main+14&gt;        sub    esp, 0x4
    0x804840c &lt;main+17&gt;        sub    esp, 0xc
    0x804840f &lt;main+20&gt;        push   0x80484b0
 &#x2192;  0x8048414 &lt;main+25&gt;        call   0x80482d0 &lt;puts@plt&gt;
   &#x21B3;   0x80482d0 &lt;puts@plt+0&gt;     jmp    DWORD PTR ds:0x80496bc
       0x80482d6 &lt;puts@plt+6&gt;     push   0x0
       0x80482db &lt;puts@plt+11&gt;    jmp    0x80482c0
       0x80482e0 &lt;__gmon_start__@plt+0&gt; jmp    DWORD PTR ds:0x80496c0
       0x80482e6 &lt;__gmon_start__@plt+6&gt; push   0x8
       0x80482eb &lt;__gmon_start__@plt+11&gt; jmp    0x80482c0
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; arguments (guessed) &#x2500;&#x2500;&#x2500;&#x2500;
puts@plt (
   [sp + 0x0] = 0x080484b0 &#x2192; &quot;hello world!&quot;,
   [sp + 0x4] = 0xffffd194 &#x2192; 0xffffd34e &#x2192; &quot;/home/devey/nightmare/modules/02-intro_tooling/hel[...]&quot;
)
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; threads &#x2500;&#x2500;&#x2500;&#x2500;
[#0] Id 1, Name: &quot;hello_world&quot;, stopped 0x8048414 in main (), reason: BREAKPOINT
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; trace &#x2500;&#x2500;&#x2500;&#x2500;
[#0] 0x8048414 &#x2192; main()
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;

Breakpoint 1, 0x08048414 in main ()
gef&#x27A4;
</code></pre>
<p>O console de debug se divide em abas. Veremos o que cada uma mostra de informa&#xE7;&#xE3;o.</p>
<h4 id="registers">Registers</h4>
<p>Aqui podemos ver o conte&#xFA;do dos registradores da CPU. Eles ser&#xE3;o usados o tempo inteiro.</p>
<pre><code class="lang-nasm">&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; registers &#x2500;&#x2500;&#x2500;&#x2500;
$eax   : 0xf7fb9dd8  &#x2192;  0xffffd19c  &#x2192;  0xffffd389  &#x2192;  &quot;CLUTTER_IM_MODULE=xim&quot;
$ebx   : 0x0       
$ecx   : 0xffffd100  &#x2192;  0x00000001
$edx   : 0xffffd124  &#x2192;  0x00000000
$esp   : 0xffffd0d0  &#x2192;  0x080484b0  &#x2192;  &quot;hello world!&quot;
$ebp   : 0xffffd0e8  &#x2192;  0x00000000
$esi   : 0xf7fb8000  &#x2192;  0x001d4d6c
$edi   : 0x0       
$eip   : 0x08048414  &#x2192;  0xfffeb7e8  &#x2192;  0x00000000
$eflags: [zero carry PARITY ADJUST SIGN trap INTERRUPT direction overflow resume virtualx86 identification]
$cs: 0x0023 $ss: 0x002b $ds: 0x002b $es: 0x002b $fs: 0x0000 $gs: 0x0063
</code></pre>
<p>No exemplo acima, temos, por exemplo:</p>
<ul>
<li><strong>$eax: 0xf7fb9dd8 &#x2192; 0xffffd19c &#x2192; 0xffffd389 &#x2192; &quot;CLUTTER_IM_MODULE=xim&quot;</strong><ul>
<li><code>eax</code> cont&#xE9;m o endere&#xE7;o <code>0xf7fb9dd8</code></li>
<li><code>0xf7fb9dd8</code> cont&#xE9;m o valor <code>0xffffd19c</code></li>
<li><code>0xffffd19c</code> aponta para <code>0xffffd389</code></li>
<li><code>0xffffd389</code> cont&#xE9;m a a string &quot;<code>CLUTTER_IM_MODULE=xim</code>&quot; (processos internos n&#xE3;o relevantes do C)</li>
</ul>
</li>
<li><strong>$ebx</strong><ul>
<li>0x0 - Vazio</li>
</ul>
</li>
<li><strong>$esp (stack pointer): 0xffffd0d0 &#x2192; 0x080484b0 &#x2192; &quot;hello world!&quot;</strong><ul>
<li><code>esp</code> cont&#xE9;m o endere&#xE7;o <code>0xffffd0d0</code> (topo da stack atual)</li>
<li><code>0xffffd0d0</code> cont&#xE9;m o endere&#xE7;o <code>0x080484b0</code></li>
<li><code>0x080484b0</code> aponta para a string &quot;Hello World!&quot;</li>
</ul>
</li>
<li><strong>$ebp (base stack pointer): 0xffffd0e8  &#x2192;  0x00000000</strong><ul>
<li><code>ebp</code> cont&#xE9;m o endere&#xE7;o 0xffffd0e8 (base da stack atual)</li>
<li><code>0xffffd0e8</code> cont&#xE9;m o valor 0x0 (zero)</li>
</ul>
</li>
</ul>
<p>Al&#xE9;m disso, temos o <strong>registrador com as flags</strong>:</p>
<ul>
<li><strong>$eflags: [zero carry PARITY ADJUST SIGN trap INTERRUPT direction overflow resume virtualx86 identification]</strong></li>
</ul>
<p>Se a flag &#xE9; mostrada, seu valor &#xE9; 1. Se n&#xE3;o for mostrada, seu valor &#xE9; 0. Como, por exemplo: </p>
<ul>
<li><code>zero</code> aparece - &#xDA;ltima opera&#xE7;&#xE3;o resultou em zero</li>
</ul>
<h4 id="stack">Stack</h4>
<p>A stack &#xE9; um dos pontos mais importantes do programa, pois uma s&#xE9;rie de vulnerabilidades envolvem explorar a maneira como a stack funciona. Nela estar&#xE3;o as vari&#xE1;veis locais, chamadas de fun&#xE7;&#xE3;o, retorno, etc.</p>
<pre><code class="lang-nasm">&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; stack &#x2500;&#x2500;&#x2500;&#x2500;
Endere&#xE7;o    Offset  Valor &#x2192; Conte&#xFA;do
0xffffd0d0&#x2502;+0x0000: 0x080484b0  &#x2192;  &quot;hello world!&quot;     &#x2190; $esp
0xffffd0d4&#x2502;+0x0004: 0xffffd194  &#x2192;  0xffffd34e  &#x2192;  &quot;/home/devey/nightmare/modules/02-intro_tooling/hel[...]&quot;
0xffffd0d8&#x2502;+0x0008: 0xffffd19c  &#x2192;  0xffffd389  &#x2192;  &quot;CLUTTER_IM_MODULE=xim&quot;
0xffffd0dc&#x2502;+0x000c: 0x08048451  &#x2192;  &lt;__libc_csu_init+33&gt; lea eax, [ebx-0xf8]
0xffffd0e0&#x2502;+0x0010: 0xf7fe59b0  &#x2192;   push ebp
0xffffd0e4&#x2502;+0x0014: 0xffffd100  &#x2192;  0x00000001
0xffffd0e8&#x2502;+0x0018: 0x00000000     &#x2190; $ebp
0xffffd0ec&#x2502;+0x001c: 0xf7dfbe81  &#x2192;  &lt;__libc_start_main+241&gt; add esp, 0x10
</code></pre>
<p>Acima, podemos ver:</p>
<ul>
<li><strong>0xffffd0d0&#x2502;+0x0000: 0x080484b0 &#x2192; &quot;hello world!&quot;    &#x2190; $esp (topo da stack)</strong><ul>
<li><code>$esp</code> est&#xE1; apontando para este endere&#xE7;o, <code>0xffffd0d0</code>. Lembra que o mesmo endere&#xE7;o estava nos registradores <code>$esp</code>, visto anteriormente?</li>
<li>Mesmo que seja o primeiro valor a ser mostrado, esse &#xE9; o <strong>topo da stack</strong>. Lembre-se que <strong><code>$esp</code> sempre aponta para o topo da stack</strong>.</li>
<li>Temos um offset <strong>+0x0000</strong>. Isso quer dizer quantos bytes estamos longe do primeiro endere&#xE7;o, <code>0xffffd0d0</code> (topo da stack).</li>
<li><code>0xffffd0d0</code> (endere&#xE7;o da stack) cont&#xE9;m <code>0x080484b0</code>, que aponta para a string &quot;Hello World!&quot;.</li>
</ul>
</li>
<li><strong>0xffffd0e8&#x2502;+0x0018: 0x00000000     &#x2190; $ebp</strong><ul>
<li><code>$ebp</code> aponta para este endere&#xE7;o da stack, <code>0xffffd0e8</code>.</li>
<li><code>0xffffd0e8</code> contem <code>0x0</code>, ou seja, zero. Isso indica que &#xE9; um valor nulo (<strong>n&#xE3;o h&#xE1; ebp salvo</strong>, o que indica que n&#xE3;o havia fun&#xE7;&#xE3;o anterior com stack e vari&#xE1;veis locais para a qual o c&#xF3;digo ir&#xE1; voltar. Isso &#xE9; v&#xE1;lido, j&#xE1; que estamos na fun&#xE7;&#xE3;o principal, a <strong>main</strong>)</li>
</ul>
</li>
<li><strong>0xffffd0ec&#x2502;+0x001c: 0xf7dfbe81  &#x2192;  <__libc_start_main+241> add esp, 0x10</__libc_start_main+241></strong><ul>
<li>Note que estamos falando de registradores com prefixo <code>e</code>, ou seja, x86 = 32 bits. <strong>Isso significa que a stack est&#xE1; de 4 em 4 bytes</strong>, como podemos ver. Isso tamb&#xE9;m quer dizer que o <strong>endere&#xE7;o de retorno para a fun&#xE7;&#xE3;o anterior</strong> sempre estar&#xE1; em <strong>ebp+0x4</strong>. E c&#xE1; estamos. em <code>0xffffd0e8</code> temos <code>ebp</code>, e em <code>0xffffd0ec</code> (<code>0xffffd0ec + 0x4</code>) temos o endere&#xE7;o da fun&#xE7;&#xE3;o <code>&lt;__libc_start_main+241&gt;</code>. Esta &#xE9; a fun&#xE7;&#xE3;o que inicializa a main.</li>
</ul>
</li>
</ul>
<p>Note tamb&#xE9;m que a <strong>stack realmente cresce negativamente</strong>, indo desde endere&#xE7;os mais altos (<code>ebp</code>) at&#xE9; endere&#xE7;os mais baixos (<code>esp</code>).</p>
<h4 id="code">Code</h4>
<p>&#xC9; aqui onde fica o <strong>c&#xF3;digo em Assembly</strong>. Em cima podemos ver a arquitetura do programa: x86 = 32 bits, ou 4 bytes.</p>
<p>A <strong>setinha</strong> mostra em qual instru&#xE7;&#xE3;o paramos (esta instru&#xE7;&#xE3;o <strong>n&#xE3;o foi executada ainda, mas ser&#xE1; a pr&#xF3;xima</strong> a ser executada).</p>
<pre><code class="lang-nasm">&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; code:x86:32 &#x2500;&#x2500;&#x2500;&#x2500;
    0x8048409 &lt;main+14&gt;        sub    esp, 0x4
    0x804840c &lt;main+17&gt;        sub    esp, 0xc
    0x804840f &lt;main+20&gt;        push   0x80484b0
 &#x2192;  0x8048414 &lt;main+25&gt;        call   0x80482d0 &lt;puts@plt&gt;
   &#x21B3;   0x80482d0 &lt;puts@plt+0&gt;     jmp    DWORD PTR ds:0x80496bc
       0x80482d6 &lt;puts@plt+6&gt;     push   0x0
       0x80482db &lt;puts@plt+11&gt;    jmp    0x80482c0
       0x80482e0 &lt;__gmon_start__@plt+0&gt; jmp    DWORD PTR ds:0x80496c0
       0x80482e6 &lt;__gmon_start__@plt+6&gt; push   0x8
       0x80482eb &lt;__gmon_start__@plt+11&gt; jmp    0x80482c0
</code></pre>
<h4 id="arguments-guessed">Arguments (guessed)</h4>
<p>Essa aba aparece quando o GDB deduz que uma fun&#xE7;&#xE3;o est&#xE1; preste a ser chamada.</p>
<pre><code class="lang-nasm">&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; arguments (guessed) &#x2500;&#x2500;&#x2500;&#x2500;
puts@plt (
   [sp + 0x0] = 0x080484b0 &#x2192; &quot;hello world!&quot;,
   [sp + 0x4] = 0xffffd194 &#x2192; 0xffffd34e &#x2192; &quot;/home/devey/nightmare/modules/02-intro_tooling/hel[...]&quot;
)
</code></pre>
<ul>
<li><strong>[sp + 0x0] = 0x080484b0 &#x2192; &quot;hello world!&quot;</strong><ul>
<li>Primeiro argumento (<code>sp+0</code>). Est&#xE1; em <code>$esp+0x0</code>, que &#xE9; o ponteiro <code>0x080484b0</code> que aponta para a string &quot;hello world&quot;.</li>
<li>Segundo argumento (<code>sp+4</code>). Provavelmente &#xE9; um artefato na stack (lixo de mem&#xF3;ria), e n&#xE3;o um argumento real, pois <code>puts()</code> s&#xF3; recebe um argumento (a string).</li>
</ul>
</li>
</ul>
<h4 id="threads">Threads</h4>
<p>Exibe informa&#xE7;&#xF5;es de threads relacionadas ao sistema operacional.</p>
<pre><code>[#0] Id 1, Name: &quot;hello_world&quot;, stopped 0x8048414 in main (), reason: BREAKPOINT
</code></pre><ul>
<li><code>#0</code> - Thread n&#xFA;mero 0 (thread principal)</li>
<li><code>id 1</code> - ID do thread no sistema operacional</li>
<li><code>Name: &quot;hello_world&quot;</code> - Nome do programa/thread</li>
<li><code>stopped 0x8048414 in main ()</code> - Parado no endere&#xE7;o 0x8048414 na fun&#xE7;&#xE3;o main()</li>
<li><code>reason: BREAKPOINT</code> - Motivo da parada: breakpoint atingido</li>
</ul>
<h4 id="trace">Trace</h4>
<p>Backtrace da execu&#xE7;&#xE3;o. Mostra pilha de chamadas (call stack)</p>
<pre><code>&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; trace &#x2500;&#x2500;&#x2500;&#x2500;
[#0] 0x8048414 &#x2192; main()
</code></pre><ul>
<li><code>#0</code> - Frame atual: executando <code>main()</code> no endere&#xE7;o 0x8048414</li>
</ul>
<p>Se houvesse mais fun&#xE7;&#xF5;es, mostraria algo como:</p>
<pre><code>[#0] 0x... &#x2192; fun&#xE7;&#xE3;o_atual()
[#1] 0x... &#x2192; fun&#xE7;&#xE3;o_chamadora()
[#2] 0x... &#x2192; main()
</code></pre><h3 id="523-visualizando">5.2.3 Visualizando</h3>
<p>&#xC9; poss&#xED;vel ver que o registrador <code>esp</code>  armazena o valor <code>0xffffd0d0</code> , que &#xE9; um ponteiro. (vis&#xED;vel no come&#xE7;o, na aba de registradores)</p>
<pre><code class="lang-nasm">$esp   : 0xffffd0d0  &#x2192;  0x080484b0  &#x2192;  &quot;hello world!&quot;
</code></pre>
<p>Para examinar as coisas com <code>x</code> , voc&#xEA; tem que especificar o que vai ser examinado, e ele mostra o conte&#xFA;do:</p>
<ul>
<li><code>x/a</code> - Endere&#xE7;o, <code>x/10c</code> - N&#xFA;mero de caracteres, <code>x/s</code>  - String, <code>x/g</code>  - Qword, <code>x/w</code>  - Dword</li>
</ul>
<p>Para visualizar o conte&#xFA;do dos registradores:</p>
<ul>
<li><code>info registers</code></li>
</ul>
<p>Para ver o stack frame (se&#xE7;&#xE3;o da stack alocada para uma &#xFA;nica fun&#xE7;&#xE3;o)</p>
<ul>
<li><code>info frame</code></li>
</ul>
<h3 id="524-mudando-valores">5.2.4 Mudando valores</h3>
<p>Se quisermos mudar o valor armazenado em <code>0x08048451</code>  para <code>0xfacade</code> :</p>
<ul>
<li><code>set 0x08048451 = 0xfacade</code></li>
</ul>
<p>Assim, podemos manipular o c&#xF3;digo do jeito que quisermos.</p>
<h2 id="53-arquivos-compilados-e-debugging-symbols">5.3 Arquivos compilados e Debugging symbols</h2>
<p>Debugging symbols s&#xE3;o <strong>metadados</strong> embutidos no arquivo execut&#xE1;vel (bin&#xE1;rio) que fornecem <strong>informa&#xE7;&#xF5;es de mapeamento entre o c&#xF3;digo bin&#xE1;rio e o c&#xF3;digo fonte original</strong>. Caso essas informa&#xE7;&#xF5;es n&#xE3;o estejam presentes no arquivo, a an&#xE1;lise fica um pouco mais dif&#xED;cil, pois perdemos algumas informa&#xE7;&#xF5;es.</p>
<h3 id="531-compilando-com--g">5.3.1 Compilando com -g</h3>
<p>No comando abaixo, estamos compilando o arquivo <code>main.c</code>, que pode ser qualquer coisa, como um simples <code>printf(&quot;Hello World!&quot;)</code>. </p>
<pre><code class="lang-bash">gcc -g -o meu_programa main.c
</code></pre>
<p>Note que usamos a op&#xE7;&#xE3;o <code>-g</code>. Essa op&#xE7;&#xE3;o <strong>ativa os metadados de Debugging Symbols</strong>. &#xC9; bem &#xFA;til para desenvolvimento de programas, de modo que fica mais f&#xE1;cil debugar o c&#xF3;digo.</p>
<p>Ao usar <code>-g</code>:</p>
<ul>
<li>Inclui informa&#xE7;&#xF5;es de debugging no execut&#xE1;vel</li>
<li>Mapeamento completo entre c&#xF3;digo fonte e assembly<pre><code>Debug Symbol: 
Endere&#xE7;o 0x8048410 &#x2192; programa.c:15 (linha no c&#xF3;digo fonte)
</code></pre></li>
<li>Nomes de vari&#xE1;veis, fun&#xE7;&#xF5;es, structs s&#xE3;o preservados</li>
<li>Arquivo maior em tamanho</li>
</ul>
<p>Comandos principais navegar no GDB em um execut&#xE1;vel com <code>-g</code>:</p>
<pre><code>(gdb) list              # Mostra c&#xF3;digo fonte
(gdb) break main        # Breakpoint por nome de fun&#xE7;&#xE3;o
(gdb) break 10          # Breakpoint por linha
(gdb) print variavel    # Mostra valor de vari&#xE1;veis
(gdb) next              # Pr&#xF3;xima linha de c&#xF3;digo
(gdb) step              # Entra em fun&#xE7;&#xF5;es
(gdb) info locals       # Vari&#xE1;veis locais
(gdb) info args         # Argumentos da fun&#xE7;&#xE3;o
</code></pre><h3 id="532-compilando-sem--g">5.3.2 Compilando sem -g</h3>
<p>Sem <code>-g</code>:</p>
<ul>
<li>Sem informa&#xE7;&#xF5;es de debugging</li>
<li>Apenas c&#xF3;digo execut&#xE1;vel</li>
<li>Arquivo menor e otimizado</li>
<li>Uso de strip adicional: <code>strip program</code></li>
</ul>
<p>Comandos principais navegar no GDB em um execut&#xE1;vel sem <code>-g</code>:</p>
<pre><code>(gdb) break *0x8048400    # Breakpoint por endere&#xE7;o
(gdb) info functions      # Lista fun&#xE7;&#xF5;es (limitado)
(gdb) disas main          # Disassembly da fun&#xE7;&#xE3;o
(gdb) nexti               # Pr&#xF3;xima instru&#xE7;&#xE3;o assembly
(gdb) stepi               # Entra em calls
(gdb) info registers      # Registradores
(gdb) x/10i $eip          # Examina instru&#xE7;&#xF5;es
</code></pre><p>&#xC9; importante tamb&#xE9;m saber que <strong>alguns comandos n&#xE3;o funcionam</strong> quando o programa &#xE9; compilado sem <code>-g</code>:</p>
<ul>
<li><code>break linha_codigo_fonte</code></li>
<li><code>print vari&#xE1;vel</code></li>
<li><code>next</code></li>
<li><code>info locals</code></li>
</ul>
<h3 id="533-compilando-sem--g--stripped">5.3.3 Compilando sem -g + stripped</h3>
<p>Outra ocasi&#xE3;o &#xE9; quando o arquivo foi completamente <code>stripped</code> - Todos os s&#xED;mbolos foram removidos, incluindo os s&#xED;mbolos b&#xE1;sicos das fun&#xE7;&#xF5;es. As fun&#xE7;&#xF5;es perdem seus nomes, inclusive a <code>main</code>. Assim, <code>b main</code> n&#xE3;o ir&#xE1; funcionar.</p>
<pre><code>gcc -o teste teste.c
strip --strip-all teste
</code></pre><p>Antes do strip, t&#xED;nhamos algumas se&#xE7;&#xF5;es no execut&#xE1;vel:</p>
<pre><code>.text    &#x2192; C&#xF3;digo execut&#xE1;vel
.data    &#x2192; Dados inicializados  
.rodata  &#x2192; Strings constantes
.symtab  &#x2192; Tabela de s&#xED;mbolos
.strtab  &#x2192; Tabela de strings
</code></pre><p>Depois do strip, sobra apenas:</p>
<pre><code>.text      (c&#xF3;digo ainda funciona)
.data   
.rodata
</code></pre><p>Para navegar com o GDB em arquivos assim, voc&#xEA; ter&#xE1; que usar o entry point:</p>
<pre><code>(gdb) break *entry_point
(gdb) si/ni para navegar
</code></pre><p>Entry point &#xE9; o endere&#xE7;o de mem&#xF3;ria onde o sistema come&#xE7;a a executar um programa. &#xC9; a primeira instru&#xE7;&#xE3;o do c&#xF3;digo que a ser executada.</p>
<h3 id="534-verificando-n&#xED;vel-de-strip-de-um-bin&#xE1;rio">5.3.4 Verificando n&#xED;vel de strip de um bin&#xE1;rio</h3>
<p>Para verificar, use o comando do <code>file arquivo</code></p>
<p>Com s&#xED;mbolos, no final haver&#xE1; <strong>not stripped</strong>:</p>
<pre><code>ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, with debug_info, not stripped
</code></pre><p>Sem s&#xED;mbolos com stripped parcial: <code>..., stripped</code></p>
<p>Completamente stripped: <code>..., no symbols</code></p>
<h2 id="54-observa&#xE7;&#xE3;o-c&#xF3;digos-n&#xE3;o-iniciam-na-main">5.4 Observa&#xE7;&#xE3;o: C&#xF3;digos n&#xE3;o iniciam na main</h2>
<p>Os c&#xF3;digos n&#xE3;o come&#xE7;am direto na fun&#xE7;&#xE3;o <code>main</code>, que &#xE9; a primeira que o programador escreve. Na verdade, primeiro temos:</p>
<ol>
<li><strong>Inicializa&#xE7;&#xE3;o do ambiente C</strong> (Libc)<ul>
<li>Inicializar alocador de mem&#xF3;ria (malloc/free)</li>
<li>Configurar buffers de I/O (Input/Output) (stdin, stdout, stderr)</li>
<li>Inicializar vari&#xE1;veis globais da libc</li>
<li>Setup de localization (locale)</li>
</ul>
</li>
<li><strong>Processamento de argumentos</strong> (do kernel para main, por exemplo)</li>
<li><strong>Inicializa&#xE7;&#xE3;o de vari&#xE1;veis globais</strong> (fora da <code>main</code>)</li>
<li><strong>Construtores de objetos C++</strong></li>
<li><strong>Alinhamento e Setup da Stack</strong></li>
<li><strong>Seguran&#xE7;a e ASLR</strong> - H&#xE1; algumas seguran&#xE7;as que dificultam a vida dos ganeshers como n&#xF3;s. Aprenderemos elas mais para frente.</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="4_ghidra.html" class="navigation navigation-prev " aria-label="Previous page: Ghidra">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="6_pwntools.html" class="navigation navigation-next " aria-label="Next page: Pwntools">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"GDB","level":"1.2.4","depth":2,"next":{"title":"Pwntools","level":"1.2.5","depth":2,"path":"introduction/6_pwntools.md","ref":"./introduction/6_pwntools.md","articles":[]},"previous":{"title":"Ghidra","level":"1.2.3","depth":2,"path":"introduction/4_ghidra.md","ref":"./introduction/4_ghidra.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"introduction/5_gdb.md","mtime":"2025-12-19T13:45:34.795Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-12-21T02:45:52.953Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

